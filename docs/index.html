<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.336">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xiaoman Guo">

<title>Macroeconometrics Research Report - Bayesian VARs Application: Inflation Rate Forecasts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objectives-motivations" id="toc-objectives-motivations" class="nav-link active" data-scroll-target="#objectives-motivations">Objectives &amp; Motivations</a></li>
  <li><a href="#data-data-properties" id="toc-data-data-properties" class="nav-link" data-scroll-target="#data-data-properties">Data &amp; Data Properties</a></li>
  <li><a href="#model-and-hypotheses" id="toc-model-and-hypotheses" class="nav-link" data-scroll-target="#model-and-hypotheses">Model and Hypotheses</a></li>
  <li><a href="#modelling-framework" id="toc-modelling-framework" class="nav-link" data-scroll-target="#modelling-framework">Modelling Framework</a>
  <ul class="collapse">
  <li><a href="#basic-model" id="toc-basic-model" class="nav-link" data-scroll-target="#basic-model">Basic Model</a></li>
  <li><a href="#model-extension" id="toc-model-extension" class="nav-link" data-scroll-target="#model-extension">Model Extension</a></li>
  <li><a href="#heteroskedasticity-model" id="toc-heteroskedasticity-model" class="nav-link" data-scroll-target="#heteroskedasticity-model">Heteroskedasticity Model</a></li>
  <li><a href="#model-proof" id="toc-model-proof" class="nav-link" data-scroll-target="#model-proof">Model Proof</a></li>
  </ul></li>
  <li><a href="#forecasting" id="toc-forecasting" class="nav-link" data-scroll-target="#forecasting">Forecasting</a>
  <ul class="collapse">
  <li><a href="#forecasting-on-basic-model" id="toc-forecasting-on-basic-model" class="nav-link" data-scroll-target="#forecasting-on-basic-model">Forecasting on basic model</a></li>
  <li><a href="#forecasting-on-extended-model" id="toc-forecasting-on-extended-model" class="nav-link" data-scroll-target="#forecasting-on-extended-model">Forecasting on extended model</a></li>
  <li><a href="#forecasting-on-heteroskedasticity-model" id="toc-forecasting-on-heteroskedasticity-model" class="nav-link" data-scroll-target="#forecasting-on-heteroskedasticity-model">Forecasting on heteroskedasticity model</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bayesian VARs Application: Inflation Rate Forecasts</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xiaoman Guo </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><strong>Abstract.</strong> This reseach project is motivated by the prevailing high inflation environment post COVID-19, aiming to investigate and forecast how inflation will evolve over time under the applicaion of the Bayesian Vector Autoregressions (VARs).</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Keywords.</strong> Bayesian VARs, inflation, cash rate, Minnesota prior, hyperparameter, stochastic volatility, heteroskedasticity, forecasting</p>
</blockquote>
<section id="objectives-motivations" class="level2">
<h2 class="anchored" data-anchor-id="objectives-motivations">Objectives &amp; Motivations</h2>
<p>Following the pandemic, inflation in Australia has rapidly increased and peaked at 7.8 percent in 2022 Quarter 4, becoming the highest rate in over 30 years. This inflationary environment risks negative economic consequences such as reduced consumer purchasing power, as well as distortions in spending behaviour and investment decisions. This is a problem not only for central banks mandated to protect price stability and sustainable economic growth, but also for individuals who need to be informed about how prices (which directly affects our daily lives) will likely evolve in the future.</p>
<p>The objective of this research project is to forecast inflation using its dynamic interaction with 9 other economic variables, using Bayesian VARs models.</p>
<p>With this, we hope to address questions such as <em>“what would be the inflation rate in the next three years?”</em> and <em>“how soon will inflation in Australia return to the annual target 2 to 3 percent?”</em>.</p>
</section>
<section id="data-data-properties" class="level2">
<h2 class="anchored" data-anchor-id="data-data-properties">Data &amp; Data Properties</h2>
<p>The 10 economic variables of interest are listed below,</p>
<ul>
<li><p><span class="math inline">\(cpi_{t}\)</span>: the Consumer Price Index from the Australian Bureau of Statistics (ABS),</p></li>
<li><p><span class="math inline">\(cashr_{t}\)</span>: the Cash Rate of the Reserve Bank of Australia (RBA),</p></li>
<li><p><span class="math inline">\(gdp_{t}\)</span>: the Gross Domestic Product per capita seasonal adjusted from the ABS,</p></li>
<li><p><span class="math inline">\(lbr_{t}\)</span>: the unit labour cost seasonal adjusted from the ABS,</p></li>
<li><p><span class="math inline">\(unem_{t}\)</span>: the unemployment rate seasonal adjusted from the ABS,</p></li>
<li><p><span class="math inline">\(constru_{t}\)</span>: the Construction Work Done seasonal adjusted from the ABS,</p></li>
<li><p><span class="math inline">\(corpft_{t}\)</span>: the company profits before income tax seasonal adjusted from the ABS,</p></li>
<li><p><span class="math inline">\(export_{t}\)</span>: the International export in Goods and Services seasonal adjusted from the ABS,</p></li>
<li><p><span class="math inline">\(import_{t}\)</span>: the International import in Goods and Services seasonal adjusted from the ABS,</p></li>
<li><p><span class="math inline">\(arri_{t}\)</span>: the Overseas Arrivals from the ABS.</p></li>
</ul>
<p><em>(Logarithm is performed on the index level data, and no data transformation is conducted on the rate data.)</em></p>
<p>Quarterly time series plots are displayed below to visualize how the 10 proposed variables vary in the past 33 years starting from September 1990 to March 2023.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/all variables plot-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/all variables plot-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most of the variables display an upward trend, with <span class="math inline">\(cashr_{t}\)</span> and <span class="math inline">\(unem_{t}\)</span> trending downwards. This strong trending pattern indicates that all the variables might integrate at 1, to know which, a formal Augmented Dickey-Fuller (ADF) test is conducted in the following section. <span class="math inline">\(corpft_{t}\)</span> and <span class="math inline">\(arri_{t}\)</span> exhibit the seasonality effect with a large drop at around Year 2021, which is a reflection of the start of the pandemic.</p>
<p>The autocorrelation (ACF) plot is presented below.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/all variables acf-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/all variables acf-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It is evident that the autocorrelation is very strong, reaching 1 at lag 1 for all variables.</p>
<p>The ADF test is conducted and presented below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Augmented Dickey-Fuller test</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>adf.results <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="fu">ncol</span>(variables_all), <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(variables_all))){</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a> adf <span class="ot">=</span> <span class="fu">adf.test</span>(variables_all[,i], <span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a> adf.results[i] <span class="ot">=</span> <span class="fu">round</span>(adf<span class="sc">$</span>p.value,<span class="dv">2</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(adf.results) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p.value"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(adf.results) <span class="ot">=</span> <span class="fu">colnames</span>(variables_all)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>adf.results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            p.value
cpi_tmp        0.31
cashr_tmp      0.01
gdp_tmp        0.84
lbr_tmp        0.62
unem_tmp       0.46
constru_tmp    0.09
corpft_tmp     0.52
export_tmp     0.45
import_tmp     0.34
arri_tmp       0.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADF test on I(1)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>diff.all <span class="ot">=</span> <span class="fu">na.omit</span>(<span class="fu">diff</span>(variables_all))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(diff.all))){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a> adf <span class="ot">=</span> <span class="fu">adf.test</span>(diff.all[,i], <span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a> adf.results[i] <span class="ot">=</span> <span class="fu">round</span>(adf<span class="sc">$</span>p.value,<span class="dv">2</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(adf.results) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"diff.p.value"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(adf.results) <span class="ot">=</span> <span class="fu">colnames</span>(variables_all)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>adf.results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            diff.p.value
cpi_tmp             0.13
cashr_tmp           0.01
gdp_tmp             0.01
lbr_tmp             0.01
unem_tmp            0.01
constru_tmp         0.01
corpft_tmp          0.01
export_tmp          0.01
import_tmp          0.01
arri_tmp            0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADF test on I(2) - CPI</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>diff2.cpi <span class="ot">=</span> <span class="fu">na.omit</span>(<span class="fu">diff</span>(diff.all[,<span class="dv">1</span>]))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>adf <span class="ot">=</span> <span class="fu">adf.test</span>(diff2.cpi, <span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>adf.results <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">round</span>(adf<span class="sc">$</span>p.value,<span class="dv">2</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(adf.results) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"2 diff.p.value"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(adf.results) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"CPI"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>adf.results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    2 diff.p.value
CPI           0.01</code></pre>
</div>
</div>
<p>According to the ADF test results, all the variables are integrated at order 1, with <span class="math inline">\(cpi_{t}\)</span> integrating at 2 and <span class="math inline">\(cashr_{t}\)</span> being stationary.</p>
<p>To keep consistency, the first difference is taken on all variables. The whole dataset is now stationary with only <span class="math inline">\(cpi_{t}\)</span> being integrated at 1. We will address this in the Minnesota prior setup in the later section.</p>
<p>After the transformation, sub-dataset is presented as a reference.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              cpi_tmp cashr_tmp
2021-12-01 0.01327820 0.0000000
2022-03-01 0.02120797 0.0000000
2022-06-01 0.01760045 0.2866667
2022-09-01 0.01807515 1.3933333
2022-12-01 0.01851905 1.0433333
2023-03-01 0.01366764 0.4866667</code></pre>
</div>
</div>
<p>Interpretations on the variables of interest,</p>
<ul>
<li><p><span class="math inline">\(cpi_{t}\)</span>: at March 2023, there’s a 1.37% increase in the inflation in a quarter time. We can sum up the last 4 observations in the above table to get the annual inflation rate. which gives 6.79%.</p></li>
<li><p><span class="math inline">\(cashr_{t}\)</span>: at March 2023, there are 49 basis points increase in the cash rate target in a quarter time since December 2022.</p></li>
</ul>
<p>The ADF test is conducted again in the transformed dataset for reference.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            p.value
cpi_tmp        0.13
cashr_tmp      0.01
gdp_tmp        0.01
lbr_tmp        0.01
unem_tmp       0.01
constru_tmp    0.01
corpft_tmp     0.01
export_tmp     0.01
import_tmp     0.01
arri_tmp       0.01</code></pre>
</div>
</div>
</section>
<section id="model-and-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="model-and-hypotheses">Model and Hypotheses</h2>
<p>The basic model equation we will build upon throughout the research project is stated below with the error term specified in the matrix-variate normal distribution. It includes a <span class="math inline">\(T \times 10\)</span> dimension mean, a <span class="math inline">\(10 \times 10\)</span> dimension row specific covariance matrix and a <span class="math inline">\(T\)</span> dimension identity matrix referring to the column specified covariance.</p>
<ul>
<li><p><span class="math inline">\(Y\)</span> is a <span class="math inline">\(T \times 10\)</span> matrix representing the <span class="math inline">\(10\)</span> variables introduced in the model as explained previously and each variable extending out to <span class="math inline">\(T\)</span> periods.</p></li>
<li><p><span class="math inline">\(X\)</span> is a <span class="math inline">\(T \times K\)</span> matrix with <span class="math inline">\(T\)</span> referring to the periods of time and <span class="math inline">\(K = 1+10 \times P\)</span> referring to <span class="math inline">\(1\)</span> intercept and <span class="math inline">\(10\)</span> variables, each of which has <span class="math inline">\(p\)</span> lags.</p></li>
<li><p><span class="math inline">\(A\)</span> is a <span class="math inline">\(K \times N\)</span> matrix with <span class="math inline">\(K\)</span> corresponding to the total number of coefficients in each equation.</p></li>
<li><p><span class="math inline">\(E\)</span> is a <span class="math inline">\(T \times 10\)</span> matrix referring to the error term in each of the equation.</p></li>
</ul>
<span class="math display">\[\begin{align}
Y &amp;= XA + E \\
\end{align}\]</span>
<span class="math display">\[\begin{align}
E |X  &amp;\sim MN_{T \times 10 } (\textbf{0}_{T\times 10}, \Sigma , I_{T}) \\
\end{align}\]</span>
</section>
<section id="modelling-framework" class="level2">
<h2 class="anchored" data-anchor-id="modelling-framework">Modelling Framework</h2>
<section id="basic-model" class="level3">
<h3 class="anchored" data-anchor-id="basic-model">Basic Model</h3>
<p>The basic model is built on the natural-conjugate prior distribution, which is specified as a matrix normal inverse Wishart distribution. Minnesota prior expressing some stylised facts about the macroeconomic time series, in this case, <span class="math inline">\(cpi_{t}\)</span> being unit root non-stationary and the rest variables being stationary, is applied to form the specifications of the prior distribution.</p>
<p>The estimation procedures to draw from the posterior follows the steps below:</p>
<p><strong>Step 1</strong>: The prior distribution is presented below. We will specify <span class="math inline">\(\underline{A}\)</span>, <span class="math inline">\(\underline{V}\)</span>, <span class="math inline">\(\underline{S}\)</span> and <span class="math inline">\(\underline{v}\)</span>.</p>
<span class="math display">\[\begin{align}
p(A,\Sigma) &amp;= p(A|\Sigma)p(\Sigma)\\
A|\Sigma &amp;\sim MN_{K\times N}(\underline{A}, \Sigma,\underline{V} ) \\
\Sigma &amp;\sim IW_{N}(\underline{S}, \underline{v})
\end{align}\]</span>
<ul>
<li><span class="math inline">\(\underline{A}\)</span> is a <span class="math inline">\(K \times N\)</span> matrix being set to reflect the random walk with no drift process on the first lag of <span class="math inline">\(cpi_{t}\)</span>, and 0 elsewhere.</li>
</ul>
<span class="math display">\[\begin{align}
\underline{A} = \left[ \underbrace{0_{N\times 1}}_{intercept} \quad
\underbrace{ \begin{bmatrix}
1 &amp; ... &amp; 0 \\
\vdots &amp;  \ddots &amp; 0 \\
0 &amp; ... &amp; 0
\end{bmatrix} }_{N \times K-1}
\right]'
\end{align}\]</span>
<ul>
<li><span class="math inline">\(\underline{V}\)</span> represents the shrinking level of the specified <span class="math inline">\(\underline{A}\)</span>. It’s a <span class="math inline">\(K\)</span> vector diagonal matrix with the diagonal elements set to be the desired shrinking level, the larger the figure, the looser the shrinkage meaning larger variance is allowed; and off-diagonal being 0 as less information can be known about the covariances among the coefficients.</li>
</ul>
<span class="math display">\[\begin{align}
\underline{V} = diag\left[ \underbrace{k_{2}}_{intercept} \quad \underbrace{k_{1}(p^{-2}\otimes l^{'}_{N})}_{A_{1} \; to\;A_{p}}  \right]
\end{align}\]</span>
<ul>
<li><p><span class="math inline">\(\underline{S}\)</span> follows the econometrics convention to set as a <span class="math inline">\(N\)</span> vector diagonal matrix with the estimated <span class="math inline">\(\widehat{\sigma}^{2}\)</span> of each variable being the diagonal elements.</p></li>
<li><p><span class="math inline">\(\underline{v}\)</span> is <span class="math inline">\(N+1\)</span>.</p></li>
</ul>
<p><strong>Step 2</strong>: The posterior distribution is presented below with the implementation of the specification in Step 1. d</p>
<span class="math display">\[\begin{align}
p(A,\Sigma | Y,X) &amp;= p(A|Y,X,\Sigma)p(\Sigma|Y,X)\\
p(A|Y,X,\Sigma)&amp;\sim MN_{K\times N}(\overline{A}, \Sigma,\overline{V} ) \\
p(\Sigma|Y,X)&amp;\sim IW_{N}(\overline{S}, \overline{v})
\end{align}\]</span>
<span class="math display">\[\begin{align}
\overline{V} &amp;= (X'X + \underline{V}^{-1})^{-1} \\
\overline{A} &amp;= \overline{V}(X'Y+\underline{V}^{-1}\underline{A}) \\
\overline{v} &amp;= T + \underline{v} \\
\overline{S} &amp;= \underline{S}+Y'Y+\underline{A'}\underline{V}^{-1}\underline{A}-\overline{A'}\overline{V}^{-1}\overline{A} \\
\end{align}\]</span>
<p><strong>Step 3</strong>: Given <span class="math inline">\(\overline{A}\)</span>, <span class="math inline">\(\overline{V}\)</span>, <span class="math inline">\(\overline{S}\)</span> and <span class="math inline">\(\overline{v}\)</span> are now specified, we can firstly draw <span class="math inline">\(\Sigma\)</span> from <span class="math inline">\(IW_{N}(\overline{S}, \overline{v})\)</span>, and take <span class="math inline">\(\Sigma\)</span> as known, then insert it in <span class="math inline">\(MN_{K\times N}(\overline{A}, \Sigma,\overline{V} )\)</span> to draw <span class="math inline">\(A\)</span>.</p>
<p>The above steps are summarised in the below code to generate the sample draws from the joint posterior distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Posterior sample draw function </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>posterior.draws       <span class="ot">=</span> <span class="cf">function</span> (S, Y, X){</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># normal-inverse Wishard posterior parameters</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    V.bar.inv         <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    V.bar             <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    A.bar             <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    nu.bar            <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    S.bar             <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    S.bar.inv         <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># posterior draws </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">rWishart</span>(S, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior,<span class="dv">3</span>,solve)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(Sigma.posterior,<span class="fu">c</span>(N,N,S))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    L                 <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      A.posterior[,,s]<span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span><span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    output            <span class="ot">=</span> <span class="fu">list</span>(<span class="at">A.posterior=</span>A.posterior, <span class="at">Sigma.posterior=</span>Sigma.posterior)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Applying function </span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># A.hat       = solve(t(X)%*%X)%*%t(X)%*%Y</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>posterior.sample.draws <span class="ot">=</span> <span class="fu">posterior.draws</span>(<span class="at">S=</span><span class="dv">50000</span>, <span class="at">Y=</span>Y, <span class="at">X=</span>X)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Presenting output</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.sample.draws<span class="sc">$</span>A.posterior, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))         <span class="co"># posterior draw A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] -0.000743 -0.070248  0.002013  0.004851  0.002973  0.007241  0.042804
[2,]  0.983434  0.149945  0.000974  0.005279  0.059050 -0.008663  0.024748
[3,]  0.002535  0.736214 -0.003785  0.013360 -0.237149  0.002128 -0.158599
[4,]  0.005177 -0.101403  0.005367  0.006208 -0.290556  0.026807  0.092750
[5,] -0.006448 -0.071092  0.017976 -0.007614 -0.048662  0.087347  0.121471
[6,]  0.002338 -0.075168 -0.002564 -0.003830  0.158969  0.025872 -0.198880
          [,8]      [,9]     [,10]
[1,]  0.010310  0.015953 -0.083014
[2,]  0.017082  0.035330  0.251647
[3,]  0.014543  0.013496 -0.016601
[4,]  0.010652 -0.026196  0.470364
[5,]  0.035005  0.051422  0.614056
[6,] -0.021868 -0.009085 -0.071842</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))       <span class="co"># posterior draw sigma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,]  0.000034  0.000159  0.000007  0.000019 -0.000369 -0.000055 -0.000002
[2,]  0.000159  0.076997  0.000334  0.000318 -0.009825  0.001176 -0.003738
[3,]  0.000007  0.000334  0.000067  0.000039 -0.001006  0.000079  0.000329
[4,]  0.000019  0.000318  0.000039  0.000121 -0.001092 -0.000040 -0.000303
[5,] -0.000369 -0.009825 -0.001006 -0.001092  0.044768 -0.001145 -0.005574
[6,] -0.000055  0.001176  0.000079 -0.000040 -0.001145  0.001521  0.001698
          [,8]      [,9]     [,10]
[1,] -0.000002 -0.000010  0.000659
[2,] -0.000603 -0.001292  0.005973
[3,]  0.000038  0.000016  0.002388
[4,]  0.000019  0.000013  0.002834
[5,] -0.000948  0.000440 -0.051620
[6,]  0.000148  0.000225  0.001477</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.sample.draws<span class="sc">$</span>A.posterior[<span class="dv">2</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"CPI"</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)    </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.sample.draws<span class="sc">$</span>A.posterior[<span class="dv">2</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"CPI"</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"CPI sigma"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"CPI sigma"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/function based on basic model-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.sample.draws<span class="sc">$</span>A.posterior[<span class="dv">3</span>,<span class="dv">2</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"Cash Rate"</span>, <span class="at">col =</span> <span class="st">"darkred"</span>) </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.sample.draws<span class="sc">$</span>A.posterior[<span class="dv">3</span>,<span class="dv">2</span>,], <span class="at">xlab =</span> <span class="st">"Cash Rate"</span>, <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior[<span class="dv">2</span>,<span class="dv">2</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"Cash rate sigma"</span>, <span class="at">col =</span> <span class="st">"pink"</span>)   </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior[<span class="dv">2</span>,<span class="dv">2</span>,], <span class="at">xlab =</span> <span class="st">"Cash rate sigma"</span>, <span class="at">col =</span> <span class="st">"pink"</span>, <span class="at">main =</span> <span class="st">''</span>)          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/function based on basic model-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The trace plots and histograms posterior draws on <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span> are presented above. From the trace plots, it’s evident that the inflation has a very strong perfect positive correlation with the prior period of itself, which aligns with the expectation of integration at 1 and the prior distribution setup. Cash rate shows some dependence to its prior period as well, with its coefficient moving between 0.5 to 1.</p>
</section>
<section id="model-extension" class="level3">
<h3 class="anchored" data-anchor-id="model-extension">Model Extension</h3>
<p>The model extension applied in this research report is to build hierarchical model. The inverse gamma 2 distribution on the Minnesota shrinkage parameter kappa <span class="math inline">\(k\)</span> is introduced and specified below.</p>
<span class="math display">\[\begin{align}
p(A,\Sigma, k |Y,X) &amp;\propto L(Y,X|A,\Sigma)p(A,\Sigma, k)\\
&amp;\propto L(Y,X|A,\Sigma)p(A |\Sigma, k)p(\Sigma)p(k)
\end{align}\]</span>
<p>where, each <span class="math inline">\(p(A |\Sigma, k)\)</span>, <span class="math inline">\(p(\Sigma)\)</span>, <span class="math inline">\(p(k)\)</span> is specified below.</p>
<span class="math display">\[\begin{align}
p(A |\Sigma, k) &amp;\sim MN_{K\times N}(\underline{A}, \Sigma, k\underline{V})\\
p(\Sigma) &amp;\sim IW_{N}(\underline{S},\underline{v})\\
p(k) &amp;\sim IG2(\underline{S_{k}}, \underline{v_{k}} ) \\
\end{align}\]</span>
<p>We multiply <span class="math inline">\(L(Y,X|A,\Sigma)p(A|\Sigma, k)p(\Sigma)p(k)\)</span> to get the kernel of the posterior distribution.</p>
<ul>
<li>The kernel of the fully conditional posterior distribution of <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span>.</li>
</ul>
<span class="math display">\[\begin{align}
p(A,\Sigma |Y,X, k) &amp;\propto L(Y,X|A,\Sigma)p(A |\Sigma, k)p(\Sigma) \\
&amp;\propto \det(\Sigma)^{-\frac{T+N+K+\underline{v}+1}{2}} \\
&amp;\exp\left\{ -\frac{1}{2} TR[\Sigma^{-1}[(A-\overline{A})'\overline{V}^{-1}(A-\overline{A})+\underline{S}+Y'Y+\underline{A}'(k\underline{V})^{-1}\underline{A}-\overline{A}'\overline{V}^{-1}\overline{A}]  ] \right\} \\
\end{align}\]</span>
<ul>
<li>The kernel of the fully conditional posterior distribution of <span class="math inline">\(k\)</span>.</li>
</ul>
<span class="math display">\[\begin{align}
p(k |Y,X,A,\Sigma ) &amp;\propto L(Y,X|A,\Sigma)p(A,\Sigma, k)\\
&amp;\propto L(Y,X|A,\Sigma)p(A |\Sigma, k)p(\Sigma)p(k) \\
&amp;\propto p(A |\Sigma, k)p(k)
\end{align}\]</span>
<span class="math display">\[\begin{align}
p(k |Y,X,A,\Sigma ) &amp;\propto \det(k\underline{V})^{-\frac{N}{2}}\exp\left\{-\frac{1}{2}TR[\Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A})] \right\} k^{-\frac{\underline{v_{k}+2}}{2}}\exp\left\{ -\frac{1}{2}\frac{\underline{S_{k}}}{k} \right\} \\
&amp; = k^{-\frac{kN+\underline{v_{k}+2}}{2}}\exp\left\{-\frac{1}{2}\frac{TR[\Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A})]+\underline{S_{k}}}{k} \right\}
\end{align}\]</span>
<p>According to the above two kernels, the equation for each posterior parameter can be written as,</p>
<span class="math display">\[\begin{align}
p(A |Y,X,\Sigma, k) &amp;\sim MN_{K\times N}(\overline{A}, \Sigma, \overline{V})\\
p(\Sigma|Y,X,A,k) &amp;\sim IW_{N}(\overline{S},\overline{v})\\
p(k |Y,X, A,\Sigma) &amp;\sim IG2(\overline{S_{k}}, \overline{v_{k}} ) \\

\overline{V} &amp;= (X'X + (k\underline{V})^{-1})^{-1}\\
\overline{A} &amp;= \overline{V}(X'Y+(k\underline{V})^{-1}\underline{A}) \\
\overline{v} &amp;= T+\underline{v}\\
\overline{S} &amp;= \underline{S}+Y'Y+\underline{A}'(k\underline{V})^{-1}\underline{A}-\overline{A}'\overline{V}^{-1}\overline{A} \\
\overline{v_{k}} &amp;= kN + \underline{v_{k}}\\
\overline{S_{k}} &amp;= TR[\Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A})]+\underline{S_{k}}\\

\end{align}\]</span>
<p>Since there is no analytical derivation of the joint posterior distribution <span class="math inline">\(p(A,\Sigma, k |Y,X)\)</span>, the Gibbs sampler method will be applied to generate random draws from the full conditional posterior distribution of <span class="math inline">\(A\)</span>, <span class="math inline">\(\Sigma\)</span> and <span class="math inline">\(k\)</span>. The steps of the sample draws are explained as follows.</p>
<p>Initialize <span class="math inline">\(k\)</span> at <span class="math inline">\(k^{(0)}\)</span>.</p>
<p>At each iteration <span class="math inline">\(s\)</span>:</p>
<ol type="1">
<li><p>Draw random matrices for <span class="math inline">\(A^{(s)}\)</span> and <span class="math inline">\(\Sigma^{(s)}\)</span> from <span class="math inline">\(p(A,\Sigma|Y,X,k^{(s-1)})\)</span>.</p></li>
<li><p>Draw a random number for <span class="math inline">\(k^{(s)}\)</span> from <span class="math inline">\(p(k |Y,X,A^{(s)},\Sigma^{(s)})\)</span>.</p></li>
</ol>
<p>Repeat steps 1 and 2 <span class="math inline">\(S_{1} + S_{2}\)</span> times.</p>
<p>Discard the first <span class="math inline">\(S_{1}\)</span> draws that allows the algorithm to converge to the stationary posterior distribution.</p>
<p>Output is the sample draws from the joint posterior distribution <span class="math inline">\(\left\{ {A^{(s)}, \Sigma^{(s)}, k^{(s)}} \right\}^{S_{1}+S_{2}}_{s=S_{1}+1}\)</span>.</p>
<p>The above steps are summarised in the below code to generate the sample draws from the joint posterior distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setup </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>S1                <span class="ot">=</span> <span class="dv">5000</span>                             <span class="co"># determine the burn-in draws</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>S2                <span class="ot">=</span> <span class="dv">45000</span>                            <span class="co"># number of draws from the final simulation</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>total_S           <span class="ot">=</span> S1<span class="sc">+</span>S2</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p),N,S1<span class="sc">+</span>S2))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(N,N,S1<span class="sc">+</span>S2))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>k.posterior       <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, S1<span class="sc">+</span>S2, <span class="dv">1</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>k.posterior[<span class="dv">1</span>]    <span class="ot">=</span> <span class="dv">10</span>                               <span class="co"># set k0 </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior IG2 distribution: kappa</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>S.k.prior         <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>nu.k.prior        <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Posterior sample draw function for extended model  </span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>posterior.draws.exten <span class="ot">=</span> <span class="cf">function</span> (total_S, Y, X){</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_S){</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># normal-inverse Wishard posterior parameters</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    V.bar.inv              <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span> <span class="fu">diag</span>( k.posterior[s]<span class="sc">*</span> V.prior))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    V.bar                  <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    A.bar                  <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>( k.posterior[s]<span class="sc">*</span> V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    nu.bar                 <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    S.bar                  <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>( k.posterior[s]<span class="sc">*</span> V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    S.bar.inv              <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># posterior draws for A and Sigma</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior.IW     <span class="ot">=</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior.draw   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior.IW,<span class="dv">3</span>,solve)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior[,,s]   <span class="ot">=</span> Sigma.posterior.draw</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,s]       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),<span class="dv">1</span>))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),<span class="dv">1</span>))</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    L                      <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,s]       <span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span><span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># posterior draws for k</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s<span class="sc">!=</span>total_S){</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    S.k.bar                <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">diag</span>( Sigma.posterior.IW[,,<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">t</span>(A.posterior[,,s]<span class="sc">-</span>A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>(A.posterior[,,s]<span class="sc">-</span>A.prior) )) <span class="sc">+</span> S.k.prior</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    nu.k.bar               <span class="ot">=</span> (<span class="dv">1</span><span class="sc">+</span>p<span class="sc">*</span>N)<span class="sc">*</span>N<span class="sc">+</span> nu.k.prior </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    k.draw.tmp             <span class="ot">=</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.k.bar)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    k.draw                 <span class="ot">=</span> S.k.bar<span class="sc">/</span>k.draw.tmp</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    k.posterior[s<span class="sc">+</span><span class="dv">1</span>]       <span class="ot">=</span> k.draw</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    output                 <span class="ot">=</span> <span class="fu">list</span> (<span class="at">A.posterior.exten =</span> A.posterior, <span class="at">Sigma.posterior.exten =</span> Sigma.posterior, <span class="at">k.posterior.exten =</span> k.posterior)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="do">## Applying function </span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>posterior.ext <span class="ot">=</span> <span class="fu">posterior.draws.exten</span>(<span class="at">total_S =</span> total_S, <span class="at">Y=</span>Y, <span class="at">X=</span>X)</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Presenting output</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] -0.000745 -0.069192  0.001160  0.004208  0.016104  0.008743  0.038578
[2,]  0.940944  0.607433  0.003072  0.014644  0.151280 -0.027432  0.163912
[3,]  0.002865  0.735629 -0.004159  0.014328 -0.242045 -0.000697 -0.169678
[4,]  0.016432 -0.550306  0.016462  0.018695 -0.883380  0.091669  0.287494
[5,] -0.016600 -0.004688  0.065086 -0.027080 -0.295537  0.311020  0.643398
[6,]  0.002791 -0.048236 -0.001736 -0.003610  0.119115  0.026231 -0.207416
          [,8]      [,9]     [,10]
[1,]  0.009331  0.017683 -0.122377
[2,]  0.053475  0.107959  0.881396
[3,]  0.013851  0.012748 -0.007498
[4,]  0.047279 -0.085489  1.730802
[5,]  0.120152  0.165785  2.178655
[6,] -0.021677 -0.006926 -0.003577</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,]  0.000030  0.000149  0.000006  0.000019 -0.000318 -0.000050 -0.000010
[2,]  0.000149  0.073056  0.000306  0.000305 -0.008407  0.000984 -0.003524
[3,]  0.000006  0.000306  0.000063  0.000038 -0.000944  0.000074  0.000325
[4,]  0.000019  0.000305  0.000038  0.000115 -0.001042 -0.000030 -0.000274
[5,] -0.000318 -0.008407 -0.000944 -0.001042  0.041814 -0.001115 -0.005620
[6,] -0.000050  0.000984  0.000074 -0.000030 -0.001115  0.001411  0.001595
          [,8]      [,9]     [,10]
[1,]  0.000002 -0.000002  0.000602
[2,] -0.000657 -0.001487  0.004673
[3,]  0.000033  0.000009  0.002226
[4,]  0.000018  0.000010  0.002701
[5,] -0.000858  0.000526 -0.048252
[6,]  0.000133  0.000166  0.001502</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(posterior.ext<span class="sc">$</span>k.posterior.exten[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S]),<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.321478</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[<span class="dv">2</span>,<span class="dv">1</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"CPI.exten"</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)   </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[<span class="dv">2</span>,<span class="dv">1</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"CPI.exten"</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten[<span class="dv">1</span>,<span class="dv">1</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"CPI sigma.exten"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>) </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten[<span class="dv">1</span>,<span class="dv">1</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"CPI sigma.exten"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/function based on extended model-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[<span class="dv">3</span>,<span class="dv">2</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"Cash Rate.exten"</span>, <span class="at">col =</span> <span class="st">"darkred"</span>) </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[<span class="dv">3</span>,<span class="dv">2</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Cash Rate.exten"</span>, <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten[<span class="dv">2</span>,<span class="dv">2</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"Cash rate sigma.exten"</span>, <span class="at">col =</span> <span class="st">"pink"</span>)   </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten[<span class="dv">2</span>,<span class="dv">2</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Cash rate sigma.exten"</span>, <span class="at">col =</span> <span class="st">"pink"</span>, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/function based on extended model-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.ext<span class="sc">$</span>k.posterior.exten[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"kappa"</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)         </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>k.posterior.exten[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"kappa"</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/function based on extended model-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Compared to the basic model, by adding the kappa <span class="math inline">\(k\)</span> into the variance specification of the prior mean <span class="math inline">\(A\)</span>, it introduces more variability of <span class="math inline">\(A\)</span>. Instead of being a fixed shrinkage level, the variance of <span class="math inline">\(A\)</span> is non-constant. This change gives evident results on the inflation, the coefficient of which now has a broader range from 0.8 to 1, rather than 0.95 to 1 as in the basic model. The results on the cash rate are not obvious. This may be due to the cash rate being a stationary series.</p>
<p>The kappa <span class="math inline">\(k\)</span> mainly concentrates between 2 to 6, with some large outlines throughout the simulation.</p>
</section>
<section id="heteroskedasticity-model" class="level3">
<h3 class="anchored" data-anchor-id="heteroskedasticity-model">Heteroskedasticity Model</h3>
<p>The model specification is as below.</p>
<span class="math display">\[\begin{align}
Y &amp;= XA + E \\
\end{align}\]</span>
<span class="math display">\[\begin{align}
E |X  &amp;\sim MN_{T \times 10 } (\textbf{0}_{T\times 10}, \Sigma , diag(\sigma_{T}^{2})) \\
\end{align}\]</span>
<p>Building upon the extended model, the posterior equations can now be written as,</p>
<span class="math display">\[\begin{align}
\overline{V} &amp;= (X'diag(\sigma_{T}^{2})^{-1}X + (k\underline{V})^{-1})^{-1}\\
\overline{A} &amp;= \overline{V}(X'diag(\sigma_{T}^{2})^{-1}Y+(k\underline{V})^{-1}\underline{A}) \\
\overline{v} &amp;= T+\underline{v}\\
\overline{S} &amp;= \underline{S}+Y'diag(\sigma_{T}^{2})^{-1}Y+\underline{A}'(k\underline{V})^{-1}\underline{A}-\overline{A}'\overline{V}^{-1}\overline{A} \\
\overline{v_{k}} &amp;= KN + \underline{v_{k}}\\
\overline{S_{k}} &amp;= TR[\Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A})]+\underline{S_{k}}\\
\end{align}\]</span>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying function </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>posterior.heter <span class="ot">=</span> <span class="fu">posterior.draw.heter</span>(<span class="at">total_S =</span> total_S, <span class="at">Y =</span> Y, <span class="at">X =</span> X, <span class="at">priors =</span> priors)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Presenting output</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.heter<span class="sc">$</span>A[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,]  0.000332 -0.065311  0.002240  0.005227  0.007821  0.008716  0.037059
[2,]  0.890855  1.637352  0.018280 -0.016282  0.831142  0.093346  0.602919
[3,]  0.004753  0.750874 -0.006219  0.012506 -0.101572 -0.002247 -0.186210
[4,]  0.034978 -0.377760  0.003441  0.087644 -1.462164  0.145770  0.428260
[5,] -0.047007 -1.332848  0.068540 -0.108985 -0.019365  0.502183  1.900900
[6,]  0.001051 -0.170756 -0.001873 -0.003092  0.204389  0.013566 -0.084760
          [,8]      [,9]     [,10]
[1,]  0.017123  0.027171  0.000631
[2,]  0.112387  0.237436  0.744664
[3,]  0.011007  0.006294 -0.008908
[4,]  0.032454 -0.477110  0.800901
[5,]  0.287586  0.599190  0.891249
[6,] -0.014719 -0.018641 -0.024438</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.heter<span class="sc">$</span>Sigma[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]      [,2]   [,3]   [,4]      [,5]     [,6]      [,7]     [,8]
[1,]  1e-06 -0.000003  0e+00  0e+00 -0.000003 -2.0e-06 -0.000007 -1.0e-06
[2,] -3e-06  0.001726  0e+00 -5e-06 -0.000172  3.5e-05 -0.000137 -3.6e-05
[3,]  0e+00  0.000000  1e-06  0e+00 -0.000004  2.0e-06  0.000008  0.0e+00
[4,]  0e+00 -0.000005  0e+00  3e-06 -0.000001 -2.0e-06 -0.000007 -1.0e-06
[5,] -3e-06 -0.000172 -4e-06 -1e-06  0.001021 -3.8e-05 -0.000267 -6.0e-06
[6,] -2e-06  0.000035  2e-06 -2e-06 -0.000038  4.6e-05  0.000027  1.0e-06
         [,9]    [,10]
[1,] -1.0e-06  0.0e+00
[2,] -3.5e-05  2.9e-05
[3,]  0.0e+00  1.0e-06
[4,] -2.0e-06  1.0e-06
[5,]  1.1e-05  2.0e-06
[6,] -4.0e-06 -6.0e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(posterior.heter<span class="sc">$</span>kappa[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S]), <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 332.97</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(posterior.heter<span class="sc">$</span>sigma2[,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="dv">1</span>, mean),<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]   13219.253   16579.473   70467.427  191465.641   11570.722  117198.482
  [7]   38430.921   51645.210   37371.977   27802.522   52296.798    3680.192
 [13]   75798.302   49696.013   21730.682   71915.475   68615.572   27536.902
 [19]   36063.626   30007.057   19965.739   44737.779   53328.360   85230.643
 [25]   84903.256   65579.722   50483.616    4702.135   55386.019   69557.032
 [31]   29016.892    5328.768   79463.512  170170.364   13230.756  172428.322
 [37]  100463.154   94098.095   43070.985   35421.887   37787.987   26477.899
 [43]   53801.118   61986.413    8213.066   73307.557   37404.540   39904.104
 [49]   48559.783   21118.778   13842.842   28903.472   13896.538   23630.653
 [55]   29038.825   19232.309    1961.061   11570.454   43378.375   27999.823
 [61]   31020.490   19067.867   15598.262   16490.335    3957.434  106279.963
 [67]    9646.350  167424.448  174607.067  185310.941  107692.665  151332.516
 [73]    5555.602  111789.836   60101.946   25413.570   50632.193   28102.979
 [79]    1587.134    5387.022   40901.292   25575.394   18165.794   18644.959
 [85]   22103.371    6307.391   17521.329   23174.361    2718.395   26893.646
 [91]   25407.054   28406.443   23279.300   12513.572   21726.967    6799.506
 [97]   25706.541   16544.363   33008.800   25769.185    1696.638   11716.436
[103]    9853.665    8285.573    8759.053   13975.251   13644.757   16744.444
[109]   17926.057    3364.225   45409.954   14173.292   78093.747 1890113.907
[115] 2399511.965 1000935.266  476923.330  380843.905  227706.634  359978.123
[121]  227018.893   43962.523   39902.387    5301.252</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.heter<span class="sc">$</span>A[<span class="dv">2</span>,<span class="dv">1</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"CPI.heter"</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>) </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[<span class="dv">2</span>,<span class="dv">1</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"CPI.heter"</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.heter<span class="sc">$</span>Sigma[<span class="dv">1</span>,<span class="dv">1</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"CPI sigma.heter"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>) </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.heter<span class="sc">$</span>Sigma[<span class="dv">1</span>,<span class="dv">1</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"CPI sigma.heter"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/heteroskedasticity 1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.heter<span class="sc">$</span>A[<span class="dv">3</span>,<span class="dv">2</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"Cash Rate.heter"</span>, <span class="at">col =</span> <span class="st">"darkred"</span>) </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.heter<span class="sc">$</span>A[<span class="dv">3</span>,<span class="dv">2</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Cash Rate.heter"</span>, <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.heter<span class="sc">$</span>Sigma[<span class="dv">2</span>,<span class="dv">2</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"Cash rate sigma.heter"</span>, <span class="at">col =</span> <span class="st">"pink"</span>)   </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.heter<span class="sc">$</span>Sigma[<span class="dv">2</span>,<span class="dv">2</span>,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Cash rate sigma.heter"</span>, <span class="at">col =</span> <span class="st">"pink"</span>, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/heteroskedasticity 1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.heter<span class="sc">$</span>kappa[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"kappa"</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>) </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.heter<span class="sc">$</span>kappa[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"kappa.heter"</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(<span class="fu">apply</span>(posterior.heter<span class="sc">$</span>sigma2[,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="dv">1</span>, mean), <span class="at">ylab =</span> <span class="st">"sigma2.heter"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/heteroskedasticity 1-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After introducing the Stochastic Volatility conditional heteroskedasticity in the model, it increases the variability of all parameters in general, however the major characteristics still preserve.</p>
<ul>
<li><p>The coefficient of the inflation still concentrates between 0.8 to 1, however many small outlines from 0.2 to 0.5 are picked up in the simulation. The trace plot of the variance of the inflation indicates more outliers than those we can find in the basic and extended model; however it’s less dispersed, proved by the narrower histogram.</p></li>
<li><p>Similar findings can be seen in the cash rate and kappa. There are more outliers, however, overall less dispersed as per histogram.</p></li>
<li><p>A worth noting plot is the heteroskedasticity variance <span class="math inline">\(\sigma_{T}^{2}\)</span>. It’s clear that the variance is not constant. It has some high variance at time 0, 40, 70 and 110, corresponding to year 1990, 2000, 2008 and 2020. Not surprisingly, there was recession, or GFC or like most recently the COVID-19 happening, which drives the high volatility in the economy and the market. This plot is within expectation and worth adding into the model for capturing the time-varying variance.</p></li>
</ul>
</section>
<section id="model-proof" class="level3">
<h3 class="anchored" data-anchor-id="model-proof">Model Proof</h3>
<p>Artificial data is generated to contain 1,000 observations simulated from a bi-variate Gaussian random walk process with the covariance matrix equal to the identity matrix of order 2. By running the below codes, it can prove that both the basic and the extended models can replicate the true parameters of the data-generating process.</p>
<p>Since the models are reviewed in the past work, the below codes are display-only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span> <span class="fu">cbind</span>(m1,m2)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Define data X, Y </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">ts</span>(m[<span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(m),], <span class="at">frequency=</span><span class="dv">1</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(Y),<span class="dv">1</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>(X,m[<span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(m)<span class="sc">-</span><span class="dv">1</span>,])</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Test on basic model</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>N           <span class="ot">=</span> <span class="fu">ncol</span>(Y)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>p           <span class="ot">=</span> <span class="fu">frequency</span>(Y)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>A.hat       <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>Y</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>Sigma.hat   <span class="ot">=</span> <span class="fu">t</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">%*%</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">/</span><span class="fu">nrow</span>(Y)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior distribution specification - Minnesota prior </span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>kappa<span class="fl">.1</span>     <span class="ot">=</span> <span class="dv">1</span>                                   <span class="co"># shrinkage for A1 to Ap</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>kappa<span class="fl">.2</span>     <span class="ot">=</span> <span class="dv">10</span>                                  <span class="co"># shrinkage for constant </span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>A.prior     <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(A.hat),<span class="fu">ncol</span>(A.hat))</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>A.prior[<span class="dv">2</span><span class="sc">:</span>(N <span class="sc">+</span> <span class="dv">1</span>),] <span class="ot">=</span> <span class="fu">diag</span>(N)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>V.prior     <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>S.prior     <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(Sigma.hat))</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>nu.prior    <span class="ot">=</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying function </span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>posterior.sample.draws <span class="ot">=</span> <span class="fu">posterior.draws</span>(<span class="at">S=</span><span class="dv">100000</span>, <span class="at">Y=</span>Y, <span class="at">X=</span>X)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(posterior.sample.draws<span class="sc">$</span>A.posterior, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setup </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>kappa<span class="fl">.1</span>     <span class="ot">=</span> <span class="dv">1</span>                                <span class="co"># shrinkage for A1 to Ap</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>kappa<span class="fl">.2</span>     <span class="ot">=</span> <span class="dv">10</span>                               <span class="co"># shrinkage for constant </span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>S1          <span class="ot">=</span> <span class="dv">100</span>                              <span class="co"># determine the burn-in draws</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>S2          <span class="ot">=</span> <span class="dv">1000</span>                             <span class="co"># number of draws from the final simulation</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>total_S     <span class="ot">=</span> S1<span class="sc">+</span>S2</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p),N,S1<span class="sc">+</span>S2))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(N,N,S1<span class="sc">+</span>S2))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>k.posterior       <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, S1<span class="sc">+</span>S2, <span class="dv">1</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>k.posterior[<span class="dv">1</span>]    <span class="ot">=</span> <span class="dv">10</span>                         <span class="co"># set k0 </span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior IG2 distribution: kappa</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>S.k.prior   <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>nu.k.prior  <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying function </span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>posterior.ext <span class="ot">=</span> <span class="fu">posterior.draws.exten</span>(<span class="at">total_S =</span> total_S, <span class="at">Y=</span>Y, <span class="at">X=</span>X)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S2], <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S2], <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="forecasting" class="level2">
<h2 class="anchored" data-anchor-id="forecasting">Forecasting</h2>
<p>The aim of the forecasting is to predict how the variable of interest <span class="math inline">\(cpi_{t}\)</span> and <span class="math inline">\(cashr_{t}\)</span> are going to evolve in the next three years, that is <span class="math inline">\(h=12\)</span> steps ahead.</p>
<p>The forecasts are built on the three models discussed in this work, namely the basic model, the extended model and the heteroskedasticity model.</p>
<section id="forecasting-on-basic-model" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-on-basic-model">Forecasting on basic model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Applying function </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>posterior.sample.draws <span class="ot">=</span> <span class="fu">posterior.draws</span>(<span class="at">S=</span><span class="dv">50000</span>, <span class="at">Y=</span>Y, <span class="at">X=</span>X)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>A.posterior.simu       <span class="ot">=</span> posterior.sample.draws<span class="sc">$</span>A.posterior</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>Sigma.posterior.simu   <span class="ot">=</span> posterior.sample.draws<span class="sc">$</span>Sigma.posterior</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Three-year ahead forecasting h=12</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set up</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>h                      <span class="ot">=</span> <span class="dv">12</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>S                      <span class="ot">=</span> <span class="dv">50000</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>Y.h                    <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(h,N,S))</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling predictive density</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  A.posterior.draw     <span class="ot">=</span> A.posterior.simu[,,s]</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior.draw <span class="ot">=</span> Sigma.posterior.simu[,,s]</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    x.Ti               <span class="ot">=</span> Y[(<span class="fu">nrow</span>(Y)<span class="sc">-</span>p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(Y),]</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    x.Ti               <span class="ot">=</span> x.Ti[p<span class="sc">:</span><span class="dv">1</span>,]</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>h){</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    x.T                <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">as.vector</span>(<span class="fu">t</span>(x.Ti)))</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    Y.f                <span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x.T<span class="sc">%*%</span>A.posterior.draw, <span class="at">sigma=</span>Sigma.posterior.draw)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>      x.Ti             <span class="ot">=</span> <span class="fu">rbind</span>(Y.f,x.Ti[<span class="dv">1</span><span class="sc">:</span>(p<span class="dv">-1</span>),])</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    Y.h[i,,s]          <span class="ot">=</span> Y.f[<span class="dv">1</span><span class="sc">:</span>N]</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="co"># transform cpi into annual cpi, and plot</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>point.cpi.h            <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">round</span>(<span class="fu">apply</span>(Y.h[,<span class="dv">1</span>,],<span class="dv">1</span>,mean),<span class="dv">6</span>))</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>cpi.data.h             <span class="ot">=</span> <span class="fu">c</span>(y[,<span class="dv">1</span>], point.cpi.h)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>cpi.data.h             <span class="ot">=</span> <span class="fu">rev</span>(cpi.data.h)</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>annual.cpi             <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="fu">length</span>(cpi.data.h)<span class="sc">-</span><span class="dv">3</span> , <span class="dv">1</span>)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> (<span class="fu">length</span>(cpi.data.h)<span class="sc">-</span><span class="dv">3</span>)) {</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>     annual.cpi[i]     <span class="ot">=</span> <span class="fu">sum</span> (cpi.data.h[i<span class="sc">:</span> (i<span class="sc">+</span><span class="dv">3</span>)])</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>annual.cpi             <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">rev</span>(annual.cpi))</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>annual.cpi             <span class="ot">=</span> <span class="fu">xts</span>(annual.cpi, <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"1992-03-01"</span>), <span class="at">by =</span> <span class="st">"quarter"</span>, <span class="at">length.out =</span> <span class="fu">length</span>(annual.cpi)))</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(annual.cpi, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">xaxt=</span><span class="st">'n'</span>)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">80</span>,<span class="dv">112</span>,<span class="dv">125</span>, <span class="fu">nrow</span>(y)<span class="sc">+</span>h),<span class="fu">c</span>(<span class="st">"1992"</span>,<span class="st">"2002"</span>,<span class="st">"2012"</span>,<span class="st">"2020"</span>,<span class="st">"2023"</span>, <span class="st">""</span>))</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.02</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">125</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">129</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">98</span>, <span class="fl">0.075</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Y2023"</span>, <span class="st">"Y2024"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting basic model-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform cash rate to not stand for a change, but an annual rate, and plot</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>point.cr.h             <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">round</span>(<span class="fu">apply</span>(Y.h[,<span class="dv">2</span>,],<span class="dv">1</span>,mean),<span class="dv">6</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>point.cr.h             <span class="ot">=</span> <span class="fu">xts</span>(point.cr.h, <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2023-06-01"</span>), <span class="at">by =</span> <span class="st">"quarter"</span>, <span class="at">length.out =</span> <span class="fu">length</span>(point.cr.h)))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>annual.cr              <span class="ot">=</span> <span class="fu">c</span>(cashr_tmp[<span class="dv">1</span><span class="sc">:</span><span class="dv">131</span>], point.cr.h)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="dv">12</span>) {</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>     annual.cr[<span class="dv">131</span><span class="sc">+</span>i]  <span class="ot">=</span>  <span class="fu">as.numeric</span>(annual.cr[<span class="dv">130</span><span class="sc">+</span>i]) <span class="sc">+</span> <span class="fu">as.numeric</span>(point.cr.h[i])</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(annual.cr<span class="sc">/</span><span class="dv">100</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">xaxt=</span><span class="st">'n'</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">48</span>,<span class="dv">88</span>,<span class="dv">120</span>,<span class="dv">131</span>, <span class="fu">nrow</span>(y)<span class="sc">+</span>h),<span class="fu">c</span>(<span class="st">"1992"</span>,<span class="st">"2002"</span>,<span class="st">"2012"</span>,<span class="st">"2020"</span>,<span class="st">"2023"</span>,<span class="st">""</span>))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">131</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">140</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">103</span>, <span class="fl">0.14</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Y2023"</span>, <span class="st">"Y2025"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting basic model-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The <span class="math inline">\(h=12\)</span> steps ahead line plot is displayed above.</p>
<p>Given the inflation data used in the model is log differences, thus each data point means the quarterly inflation rate. I transformed the data by summing up the past 4 consecutive data points together for every single data point to get an annualised figure for each period. Taking a look at the plot, we can see as at 2023 Quarter 1, the annual inflation rate is over 6%; based on our forecasting, the annual inflation rate is going to gradually decrease during 2023, and reaching at the target level 2% at 2023 Quarter 4. Thereafter, the annual inflation will keep decreasing. It will turn to increase again after it reaches 0 in 2024 to 2025.</p>
<p>The cash rate is transformed to represent the annual cash rate at each quarter, rather than the cash rate movements. According to the forecasts, the cash rate would slightly increase after the 3.31% reported on 2023 Quarter 1, then keeps decreasing all the way, reaching at the lowest, around 1% in 2025.</p>
<p>3D with density intervals for the inflation and cash rate are plotted below. The quarterly inflation rate and cash rate change don’t seem to vary much in the next 3 years, the bounded confidence interval (i.e.&nbsp;green shaded area) is not wide as well. However, the accumulative effect by adding the changes to generate the annualised rate does turn thing around as explained above. The different height of the intervals mean how certain the prediction is, as it goes further into the future, the interval become more wider and dispersed, resulting from the increased uncertainty.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting plot basic model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="forecasting-on-extended-model" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-on-extended-model">Forecasting on extended model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Applying function </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>S1                         <span class="ot">=</span> <span class="dv">5000</span>                              <span class="co"># determine the burn-in draws</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>S2                         <span class="ot">=</span> <span class="dv">45000</span>                             <span class="co"># number of draws from the final simulation</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>total_S                    <span class="ot">=</span> S1<span class="sc">+</span>S2</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>posterior.ext              <span class="ot">=</span> <span class="fu">posterior.draws.exten</span>(<span class="at">total_S =</span> total_S, <span class="at">Y=</span>Y, <span class="at">X=</span>X)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>A.posterior.ext.simu       <span class="ot">=</span> posterior.ext<span class="sc">$</span>A.posterior.exten[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>Sigma.posterior.ext.simu   <span class="ot">=</span> posterior.ext<span class="sc">$</span>Sigma.posterior.exten[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Three-year ahead forecasting h=12</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># set up</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>h                          <span class="ot">=</span> <span class="dv">12</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>S                          <span class="ot">=</span> <span class="dv">45000</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>Y.h.ext                    <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(h,N,S))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling predictive density</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  A.posterior.draw         <span class="ot">=</span> A.posterior.ext.simu[,,s]</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior.draw     <span class="ot">=</span> Sigma.posterior.ext.simu[,,s]</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    x.Ti                   <span class="ot">=</span> Y[(<span class="fu">nrow</span>(Y)<span class="sc">-</span>p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(Y),]</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    x.Ti                   <span class="ot">=</span> x.Ti[p<span class="sc">:</span><span class="dv">1</span>,]</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>h){</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    x.T                    <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">as.vector</span>(<span class="fu">t</span>(x.Ti)))</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    Y.f                    <span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x.T<span class="sc">%*%</span>A.posterior.draw, <span class="at">sigma=</span>Sigma.posterior.draw)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>      x.Ti                 <span class="ot">=</span> <span class="fu">rbind</span>(Y.f,x.Ti[<span class="dv">1</span><span class="sc">:</span>(p<span class="dv">-1</span>),])</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    Y.h.ext[i,,s]          <span class="ot">=</span> Y.f[<span class="dv">1</span><span class="sc">:</span>N]</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co"># transform cpi into annual cpi, and plot</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>point.cpi.h                <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">round</span>(<span class="fu">apply</span>(Y.h.ext[,<span class="dv">1</span>,],<span class="dv">1</span>,mean),<span class="dv">6</span>))</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>cpi.data.h                 <span class="ot">=</span> <span class="fu">c</span>(y[,<span class="dv">1</span>], point.cpi.h)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>cpi.data.h                 <span class="ot">=</span> <span class="fu">rev</span>(cpi.data.h)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>annual.cpi                 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="fu">length</span>(cpi.data.h)<span class="sc">-</span><span class="dv">3</span> , <span class="dv">1</span>)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> (<span class="fu">length</span>(cpi.data.h)<span class="sc">-</span><span class="dv">3</span>)) {</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>     annual.cpi[i]         <span class="ot">=</span> <span class="fu">sum</span> (cpi.data.h[i<span class="sc">:</span> (i<span class="sc">+</span><span class="dv">3</span>)])</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>annual.cpi                 <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">rev</span>(annual.cpi))</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>annual.cpi                 <span class="ot">=</span> <span class="fu">xts</span>(annual.cpi, <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"1992-03-01"</span>), <span class="at">by =</span> <span class="st">"quarter"</span>, <span class="at">length.out =</span> <span class="fu">length</span>(annual.cpi)))</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(annual.cpi, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">xaxt=</span><span class="st">'n'</span>)</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">80</span>,<span class="dv">112</span>,<span class="dv">125</span>, <span class="fu">nrow</span>(y)<span class="sc">+</span>h),<span class="fu">c</span>(<span class="st">"1992"</span>,<span class="st">"2002"</span>,<span class="st">"2012"</span>,<span class="st">"2020"</span>,<span class="st">"2023"</span>, <span class="st">""</span>))</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.02</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">125</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">129</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">98</span>, <span class="fl">0.075</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Y2023"</span>, <span class="st">"Y2024"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting on extended model-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform cash rate to not stand for a change, but an annual rate, and plot</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>point.cr.h                 <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">round</span>(<span class="fu">apply</span>(Y.h.ext[,<span class="dv">2</span>,],<span class="dv">1</span>,mean),<span class="dv">6</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>point.cr.h                 <span class="ot">=</span> <span class="fu">xts</span>(point.cr.h, <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2023-06-01"</span>), <span class="at">by =</span> <span class="st">"quarter"</span>, <span class="at">length.out =</span> <span class="fu">length</span>(point.cr.h)))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>annual.cr                  <span class="ot">=</span> <span class="fu">c</span>(cashr_tmp[<span class="dv">1</span><span class="sc">:</span><span class="dv">131</span>], point.cr.h)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="dv">12</span>) {</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>     annual.cr[<span class="dv">131</span><span class="sc">+</span>i]  <span class="ot">=</span>  <span class="fu">as.numeric</span>(annual.cr[<span class="dv">130</span><span class="sc">+</span>i]) <span class="sc">+</span> <span class="fu">as.numeric</span>(point.cr.h[i])</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(annual.cr<span class="sc">/</span><span class="dv">100</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">xaxt=</span><span class="st">'n'</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">48</span>,<span class="dv">88</span>,<span class="dv">120</span>,<span class="dv">131</span>, <span class="fu">nrow</span>(y)<span class="sc">+</span>h),<span class="fu">c</span>(<span class="st">"1992"</span>,<span class="st">"2002"</span>,<span class="st">"2012"</span>,<span class="st">"2020"</span>,<span class="st">"2023"</span>,<span class="st">""</span>))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">131</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">140</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">103</span>, <span class="fl">0.14</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Y2023"</span>, <span class="st">"Y2025"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting on extended model-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A view of the plots above, the overall trends in the next 3 years are very similar in both basic and extended model. Only that the inflation rate would return to the target level a bit early than what’s forecasted in the basic model; however there is no significant difference. The forecasts of the annual cash rate is similar in both model, just that the lowest point is relatively lower, below 0.50%, in the extended model.</p>
<p>The below 3D plots doesn’t have many differences. Just the confidence intervals for the inflation is narrowed and every density is higher than it’s in the basic model, which indicates the extended model might have a higher certainty in predicting the inflation.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting plot on extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="forecasting-on-heteroskedasticity-model" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-on-heteroskedasticity-model">Forecasting on heteroskedasticity model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Applying function </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>S1                           <span class="ot">=</span> <span class="dv">5000</span>                              <span class="co"># determine the burn-in draws</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>S2                           <span class="ot">=</span> <span class="dv">45000</span>                             <span class="co"># number of draws from the final simulation</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>total_S                      <span class="ot">=</span> S1<span class="sc">+</span>S2</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>posterior.heter              <span class="ot">=</span> <span class="fu">posterior.draw.heter</span>(<span class="at">total_S =</span> total_S, <span class="at">Y =</span> Y, <span class="at">X =</span> X, <span class="at">priors =</span> priors)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>A.posterior.heter.simu       <span class="ot">=</span> posterior.heter<span class="sc">$</span>A[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S]</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>Sigma.posterior.heter.simu   <span class="ot">=</span> posterior.heter<span class="sc">$</span>Sigma[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S]</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Three-year ahead forecasting h=12</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># set up</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>h                            <span class="ot">=</span> <span class="dv">12</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>S                            <span class="ot">=</span> <span class="dv">45000</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>Y.h.heter                    <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(h,N,S))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling predictive density</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  A.posterior.draw           <span class="ot">=</span> A.posterior.heter.simu[,,s]</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior.draw       <span class="ot">=</span> Sigma.posterior.heter.simu[,,s]</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    x.Ti                     <span class="ot">=</span> Y[(<span class="fu">nrow</span>(Y)<span class="sc">-</span>p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(Y),]</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    x.Ti                     <span class="ot">=</span> x.Ti[p<span class="sc">:</span><span class="dv">1</span>,]</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>h){</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    x.T                      <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">as.vector</span>(<span class="fu">t</span>(x.Ti)))</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    Y.f                      <span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x.T<span class="sc">%*%</span>A.posterior.draw, <span class="at">sigma=</span>Sigma.posterior.draw)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>      x.Ti                   <span class="ot">=</span> <span class="fu">rbind</span>(Y.f,x.Ti[<span class="dv">1</span><span class="sc">:</span>(p<span class="dv">-1</span>),])</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    Y.h.heter[i,,s]          <span class="ot">=</span> Y.f[<span class="dv">1</span><span class="sc">:</span>N]</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="co"># transform cpi into annual cpi, and plot</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>point.cpi.h                <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">round</span>(<span class="fu">apply</span>(Y.h.heter[,<span class="dv">1</span>,],<span class="dv">1</span>,mean),<span class="dv">6</span>))</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>cpi.data.h                 <span class="ot">=</span> <span class="fu">c</span>(y[,<span class="dv">1</span>], point.cpi.h)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>cpi.data.h                 <span class="ot">=</span> <span class="fu">rev</span>(cpi.data.h)</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>annual.cpi                 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="fu">length</span>(cpi.data.h)<span class="sc">-</span><span class="dv">3</span> , <span class="dv">1</span>)</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> (<span class="fu">length</span>(cpi.data.h)<span class="sc">-</span><span class="dv">3</span>)) {</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>     annual.cpi[i]         <span class="ot">=</span> <span class="fu">sum</span> (cpi.data.h[i<span class="sc">:</span> (i<span class="sc">+</span><span class="dv">3</span>)])</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>annual.cpi                 <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">rev</span>(annual.cpi))</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>annual.cpi                 <span class="ot">=</span> <span class="fu">xts</span>(annual.cpi, <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"1992-03-01"</span>), <span class="at">by =</span> <span class="st">"quarter"</span>, <span class="at">length.out =</span> <span class="fu">length</span>(annual.cpi)))</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(annual.cpi, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">xaxt=</span><span class="st">'n'</span>)</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">80</span>,<span class="dv">112</span>,<span class="dv">125</span>, <span class="fu">nrow</span>(y)<span class="sc">+</span>h),<span class="fu">c</span>(<span class="st">"1992"</span>,<span class="st">"2002"</span>,<span class="st">"2012"</span>,<span class="st">"2020"</span>,<span class="st">"2023"</span>, <span class="st">""</span>))</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.02</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">125</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">129</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">98</span>, <span class="fl">0.075</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Y2023"</span>, <span class="st">"Y2024"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting heteroskedasticity-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform cash rate to not stand for a change, but an annual rate, and plot</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>point.cr.h                 <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">round</span>(<span class="fu">apply</span>(Y.h.heter[,<span class="dv">2</span>,],<span class="dv">1</span>,mean),<span class="dv">6</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>point.cr.h                 <span class="ot">=</span> <span class="fu">xts</span>(point.cr.h, <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2023-06-01"</span>), <span class="at">by =</span> <span class="st">"quarter"</span>, <span class="at">length.out =</span> <span class="fu">length</span>(point.cr.h)))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>annual.cr                  <span class="ot">=</span> <span class="fu">c</span>(cashr_tmp[<span class="dv">1</span><span class="sc">:</span><span class="dv">131</span>], point.cr.h)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="dv">12</span>) {</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>     annual.cr[<span class="dv">131</span><span class="sc">+</span>i]  <span class="ot">=</span>  <span class="fu">as.numeric</span>(annual.cr[<span class="dv">130</span><span class="sc">+</span>i]) <span class="sc">+</span> <span class="fu">as.numeric</span>(point.cr.h[i])</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(annual.cr<span class="sc">/</span><span class="dv">100</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">xaxt=</span><span class="st">'n'</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">48</span>,<span class="dv">88</span>,<span class="dv">120</span>,<span class="dv">131</span>, <span class="fu">nrow</span>(y)<span class="sc">+</span>h),<span class="fu">c</span>(<span class="st">"1992"</span>,<span class="st">"2002"</span>,<span class="st">"2012"</span>,<span class="st">"2020"</span>,<span class="st">"2023"</span>,<span class="st">""</span>))</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">131</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">140</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">103</span>, <span class="fl">0.14</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Y2023"</span>, <span class="st">"Y2025"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting heteroskedasticity-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Like in the basic and extended model, the heteroskedasticity model gives the prediction that the annual inflation will return to the target level before the start of year 2024 as well. However, it predicts the inflation will decrease way more below 0 than the other two models, indicating the economy would experience downturn in 2024 and 2025. This discrepancy is likely due to the time-varying volatility introduced in this model. The time dependence of the dropping inflation lasts longer and the high volatility in the inflation movements in the past period remains high in the following periods, therefore the annual inflation dropped deeper in 2024.</p>
<p>The forecasts on the annual cash rate remains consistent among three models.</p>
<p>3D density is plotted below for reference. It looks quite different than what we see in the basic and extended models. The densities are very sharp and concentrated around the point estimates. As we forecast further into the future, the densities do not become dispersed, whereas it preserves the similar shape as in the near periods. This may result from the varying column variance replaced each time in estimating <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span>, hence each <span class="math inline">\(\Sigma\)</span> contains more information. When forecasting into the future, it increases the certainty.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/forecasting plot heteroskedasticity-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Interactive versions of the above 3D plots are provided below to allow access to alternative vantage points.</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8dc05b702c8a53629620" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8dc05b702c8a53629620">{"x":{"visdat":{"340445a976cf":["function () ","plotlyVisDat"]},"cur_data":"340445a976cf","attrs":{"340445a976cf":{"y":[1,2,3,4,5,6,7,8,9,10,11,12],"x":[-3.29873452842936,-2.03596160089096,-0.773188673352555,0.489584254185849,1.75235718172425,3.01513010926266,4.27790303680106,5.54067596433946,6.80344889187787],"z":[[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0.000211175470150834,0.791696837595475,0,0,0,0,0],[0,0,0.000651124366298403,0.791256888699327,0,0,0,0,0],[0,0,0.00119666099752139,0.790711352068104,0,0,0,0,0],[0,0,0.00225253834827556,0.78965547471735,0,0,0,0,0],[0,0,0.00353718912502646,0.788353225984753,1.75979558459028e-05,0,0,0,0],[1.75979558459028e-05,3.51959116918056e-05,0.00524419084207903,0.786558234488471,5.27938675377084e-05,0,0,0,0],[1.75979558459028e-05,1.75979558459028e-05,0.0069335946032857,0.784798438903881,0.000105587735075417,1.75979558459028e-05,0,0,1.75979558459028e-05]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","colors":["#05386B","#8EE4AF","#EDF5E1"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"cpi"},"yaxis":{"title":"h-step forecast"},"zaxis":{"title":"density"}},"title":"CPI forecast densities","hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(5,56,107,1)"],["0.0416666666666667","rgba(28,69,113,1)"],["0.0833333333333333","rgba(42,81,119,1)"],["0.125","rgba(54,95,125,1)"],["0.166666666666667","rgba(65,109,130,1)"],["0.208333333333333","rgba(76,123,136,1)"],["0.25","rgba(86,137,142,1)"],["0.291666666666667","rgba(95,151,148,1)"],["0.333333333333333","rgba(105,166,153,1)"],["0.375","rgba(114,181,159,1)"],["0.416666666666667","rgba(124,197,164,1)"],["0.458333333333333","rgba(133,212,170,1)"],["0.5","rgba(142,228,175,1)"],["0.541666666666667","rgba(151,230,179,1)"],["0.583333333333333","rgba(159,231,183,1)"],["0.625","rgba(168,233,187,1)"],["0.666666666666667","rgba(176,234,191,1)"],["0.708333333333333","rgba(184,236,196,1)"],["0.75","rgba(192,237,200,1)"],["0.791666666666667","rgba(199,238,204,1)"],["0.833333333333333","rgba(207,240,208,1)"],["0.875","rgba(215,241,212,1)"],["0.916666666666667","rgba(222,242,217,1)"],["0.958333333333333","rgba(230,244,221,1)"],["1","rgba(237,245,225,1)"]],"showscale":true,"y":[1,2,3,4,5,6,7,8,9,10,11,12],"x":[-3.29873452842936,-2.03596160089096,-0.773188673352555,0.489584254185849,1.75235718172425,3.01513010926266,4.27790303680106,5.54067596433946,6.80344889187787],"z":[[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0,0.791908013065625,0,0,0,0,0],[0,0,0.000211175470150834,0.791696837595475,0,0,0,0,0],[0,0,0.000651124366298403,0.791256888699327,0,0,0,0,0],[0,0,0.00119666099752139,0.790711352068104,0,0,0,0,0],[0,0,0.00225253834827556,0.78965547471735,0,0,0,0,0],[0,0,0.00353718912502646,0.788353225984753,1.75979558459028e-05,0,0,0,0],[1.75979558459028e-05,3.51959116918056e-05,0.00524419084207903,0.786558234488471,5.27938675377084e-05,0,0,0,0],[1.75979558459028e-05,1.75979558459028e-05,0.0069335946032857,0.784798438903881,0.000105587735075417,1.75979558459028e-05,0,0,1.75979558459028e-05]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2afd8a149fa6ee69adbd" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2afd8a149fa6ee69adbd">{"x":{"visdat":{"34041e4d1297":["function () ","plotlyVisDat"]},"cur_data":"34041e4d1297","attrs":{"34041e4d1297":{"y":[1,2,3,4,5,6,7,8,9,10,11,12],"x":[-73.146496435334,-46.787209236957,-20.42792203858,5.93136515979705,32.2906523581741,58.6499395565511,85.0092267549281,111.368513953305,137.727801151682],"z":[[0,0,0,0.0379372929349004,0,0,0,0,0],[0,0,0,0.0379372929349004,0,0,0,0,0],[0,0,0,0.0379372929349004,0,0,0,0,0],[0,0,0,0.0379372929349004,0,0,0,0,0],[0,0,5.90135667876229e-06,0.0379313915782217,0,0,0,0,0],[0,0,1.6861019082178e-05,0.0379204319158182,0,0,0,0,0],[0,0,3.2878987210247e-05,0.0379044139476902,0,0,0,0,0],[0,0,5.14261082006428e-05,0.0378841807247916,1.6861019082178e-06,0,0,0,0],[0,0,7.92467896862365e-05,0.0378521447885354,5.90135667876229e-06,0,0,0,0],[0,1.6861019082178e-06,0.000106224420217721,0.0378167366484628,1.18027133575246e-05,8.43050954108899e-07,0,0,0],[0,4.21525477054449e-06,0.00013741730551975,0.0377762702026656,1.60179681280691e-05,2.5291528623267e-06,8.43050954108898e-07,0,0],[2.52915286232669e-06,8.43050954108898e-06,0.000180412904179304,0.0377012386677499,3.54081400725737e-05,5.90135667876229e-06,2.52915286232669e-06,0,8.43050954108899e-07]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","colors":["#05386B","magenta2","#EDF5E1"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"cash rate"},"yaxis":{"title":"h-step forecast"},"zaxis":{"title":"density"}},"title":"Cash rate forecast densities","hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(5,56,107,1)"],["0.0416666666666667","rgba(40,58,117,1)"],["0.0833333333333333","rgba(62,60,127,1)"],["0.125","rgba(81,61,138,1)"],["0.166666666666667","rgba(99,62,148,1)"],["0.208333333333333","rgba(116,61,159,1)"],["0.25","rgba(134,60,170,1)"],["0.291666666666667","rgba(151,58,181,1)"],["0.333333333333333","rgba(168,55,192,1)"],["0.375","rgba(185,49,203,1)"],["0.416666666666667","rgba(203,42,215,1)"],["0.458333333333333","rgba(220,29,226,1)"],["0.5","rgba(238,0,238,1)"],["0.541666666666667","rgba(240,59,237,1)"],["0.583333333333333","rgba(242,85,237,1)"],["0.625","rgba(243,106,236,1)"],["0.666666666666667","rgba(244,125,235,1)"],["0.708333333333333","rgba(245,142,234,1)"],["0.75","rgba(245,158,233,1)"],["0.791666666666667","rgba(245,173,232,1)"],["0.833333333333333","rgba(245,188,231,1)"],["0.875","rgba(243,203,230,1)"],["0.916666666666667","rgba(242,217,228,1)"],["0.958333333333333","rgba(240,231,227,1)"],["1","rgba(237,245,225,1)"]],"showscale":true,"y":[1,2,3,4,5,6,7,8,9,10,11,12],"x":[-73.146496435334,-46.787209236957,-20.42792203858,5.93136515979705,32.2906523581741,58.6499395565511,85.0092267549281,111.368513953305,137.727801151682],"z":[[0,0,0,0.0379372929349004,0,0,0,0,0],[0,0,0,0.0379372929349004,0,0,0,0,0],[0,0,0,0.0379372929349004,0,0,0,0,0],[0,0,0,0.0379372929349004,0,0,0,0,0],[0,0,5.90135667876229e-06,0.0379313915782217,0,0,0,0,0],[0,0,1.6861019082178e-05,0.0379204319158182,0,0,0,0,0],[0,0,3.2878987210247e-05,0.0379044139476902,0,0,0,0,0],[0,0,5.14261082006428e-05,0.0378841807247916,1.6861019082178e-06,0,0,0,0],[0,0,7.92467896862365e-05,0.0378521447885354,5.90135667876229e-06,0,0,0,0],[0,1.6861019082178e-06,0.000106224420217721,0.0378167366484628,1.18027133575246e-05,8.43050954108899e-07,0,0,0],[0,4.21525477054449e-06,0.00013741730551975,0.0377762702026656,1.60179681280691e-05,2.5291528623267e-06,8.43050954108898e-07,0,0],[2.52915286232669e-06,8.43050954108898e-06,0.000180412904179304,0.0377012386677499,3.54081400725737e-05,5.90135667876229e-06,2.52915286232669e-06,0,8.43050954108899e-07]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this research project, we closely examined three Bayesian VARs models to forecast the variables of interest, namely the inflation <span class="math inline">\(cpi_{t}\)</span> and the cash rate <span class="math inline">\(cashr_{t}\)</span>. We start from the basic model with simple Minnesota prior specifications to capture the features and dynamic relationships we found in our variables. We built a hierarchical model by imposing the Minnesota shrinkage hyperparameter kappa <span class="math inline">\(k\)</span> on top of the basic model. We enhanced the hierarchical model by introducing the stochastic volatilites. We conducted 12-step ahead forecasts on each of the models and compared the results.</p>
<p>The forecasts provided by the three models are similar and consistent in general with some small discrepancies. All three models provide forecasts that the annual inflation rate in three years time will be around the target level 2% or less. The annual inflation in Australia will return to the annual target 2-3% no later than the start of 2024. The annual cash rate will be constantly decreasing from the reported 3.31% in 2023 Quarter 1 to the lowest, around 0.50-1%, in 2025.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>